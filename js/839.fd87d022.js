"use strict";(self["webpackChunkvue_router"]=self["webpackChunkvue_router"]||[]).push([[839],{839:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var s=a(6252),l=a(3577),d=a(9963);const o=e=>((0,s.dD)("data-v-d186d1f4"),e=e(),(0,s.Cn)(),e),r={class:"container"},i=(0,s.uE)('<div data-v-d186d1f4><div class="d-flex justify-content-around w-50 mx-auto my-5" data-v-d186d1f4><div data-v-d186d1f4><div class="rounded-pill text-center order-shape mx-auto mb-1" data-v-d186d1f4><p class="pt-2" data-v-d186d1f4>1</p></div><p class="text-center fs-7" data-v-d186d1f4>填寫資料</p></div><div data-v-d186d1f4><div class="rounded-pill text-center order-shape-light mx-auto mb-1" data-v-d186d1f4><p class="pt-2" data-v-d186d1f4>2</p></div><p class="text-center fs-7" data-v-d186d1f4>確認訂單</p></div><div data-v-d186d1f4><div class="rounded-pill text-center order-shape-light mx-auto mb-1" data-v-d186d1f4><p class="pt-2" data-v-d186d1f4>3</p></div><p class="text-center fs-7" data-v-d186d1f4>購買完成</p></div></div></div>',1),c={class:"table-cus"},n=o((()=>(0,s._)("h5",{class:"h5 bg-danger bg-gradient rounded-top p-3 text-white",style:{"--bs-bg-opacity":"0.5"}}," 購物車 ",-1))),u={key:0,class:"text-center p-5"},p=o((()=>(0,s._)("p",null,"購物車內沒有商品喔",-1))),m=o((()=>(0,s._)("button",{type:"button",class:"btn btn-danger w-25 text-white bg-gradient"}," 前往逛逛 ",-1))),h={key:1,class:"px-4"},f={class:"w-100 mt-4",ref:"table"},g=o((()=>(0,s._)("thead",{class:"thead"},[(0,s._)("tr",{class:"text-center"},[(0,s._)("th",{scope:"col",class:"py-3"},"商品資訊"),(0,s._)("th",{scope:"col"},"單件價格"),(0,s._)("th",{scope:"col"})])],-1))),v={class:"border-bottom"},_={class:"p-3"},b={class:"d-md-flex d-block align-items-center"},x=["src","alt"],y={class:"mt-2 text-center"},w={key:0},C={key:1,class:"text-danger"},k=o((()=>(0,s._)("br",null,null,-1))),$={class:"text-secondary fs-7"},D=["onUpdate:modelValue","onChange"],V=["value"],L=["onClick"],U=o((()=>(0,s._)("i",{class:"bi bi-trash text-secondary fs-6"},null,-1))),W=[U],q={class:"row"},z={class:"col-6 mt-4"},I={class:"col-6"},N={class:"mt-4"},T={class:"d-flex"},j={class:"mt-3"},M={class:"d-flex justify-content-between"},E=o((()=>(0,s._)("p",null,"商品小計",-1))),O={class:"d-flex justify-content-between"},A=o((()=>(0,s._)("p",null,"折抵金額",-1))),F={class:"d-flex justify-content-between mt-3"},H=o((()=>(0,s._)("p",null,"結帳金額",-1))),Y={class:"text-danger fs-5-5"},K={class:"table-cus my-5"},S=o((()=>(0,s._)("h5",{class:"h5 bg-danger bg-gradient rounded-top p-3 text-white",style:{"--bs-bg-opacity":"0.5"}}," 填寫顧客資訊 ",-1))),Z={class:"p-4"},B={class:"mb-3"},G=o((()=>(0,s._)("label",{for:"name",class:"form-label"},[(0,s.Uk)("姓名"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),J={class:"mb-3"},P=o((()=>(0,s._)("label",{for:"email",class:"form-label"},[(0,s.Uk)("Email"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),Q={class:"mb-3"},R=o((()=>(0,s._)("label",{for:"phone",class:"form-label"},[(0,s.Uk)("聯絡電話"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),X={class:"mb-3"},ee=o((()=>(0,s._)("label",{for:"address",class:"form-label"},[(0,s.Uk)("收件地址"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),te={class:"mb-3"},ae=o((()=>(0,s._)("label",{for:"message",class:"form-label"},"留言",-1))),se=["disabled"];function le(e,t,a,o,U,le){const de=(0,s.up)("LoadingOverlay"),oe=(0,s.up)("router-link"),re=(0,s.up)("VField"),ie=(0,s.up)("ErrorMessage"),ce=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(de,{active:U.isLoading,"z-indes":1e3},null,8,["active"]),(0,s._)("div",r,[i,(0,s._)("div",c,[n,0===U.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",u,[p,(0,s.Wm)(oe,{to:"/products"},{default:(0,s.w5)((()=>[m])),_:1})])):((0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("table",f,[g,(0,s._)("tbody",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(U.cartData.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{class:"text-center",key:e.id},[(0,s._)("td",_,[(0,s._)("div",b,[(0,s._)("img",{src:e.product.imageUrl,alt:e.product.title,class:"cart-img me-3 rounded-3"},null,8,x),(0,s._)("h6",y,(0,l.zw)(e.product.title),1)])]),(0,s._)("td",null,[e.product.price===e.product.origin_price?((0,s.wg)(),(0,s.iD)("p",w," NT$ "+(0,l.zw)(e.product.price),1)):((0,s.wg)(),(0,s.iD)("p",C,[(0,s.Uk)(" NT$ "+(0,l.zw)(e.product.price)+" ",1),k,(0,s._)("del",$,"NT$ "+(0,l.zw)(e.product.origin_price),1)])),(0,s.wy)((0,s._)("select",{name:"qty",id:"qty",class:"form-select w-75","onUpdate:modelValue":t=>e.qty=t,onChange:t=>le.changeCart(e)},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(t=>(0,s._)("option",{value:t,key:`${e.id} + ${t}`},(0,l.zw)(t),9,V))),64))],40,D),[[d.bM,e.qty]])]),(0,s._)("td",null,[(0,s._)("a",{href:"#",onClick:(0,d.iM)((t=>le.deleteCart(e.id)),["prevent"])},W,8,L)])])))),128))])],512),(0,s._)("div",q,[(0,s._)("div",z,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[0]||(t[0]=(...e)=>le.deleteAllCart&&le.deleteAllCart(...e))}," 清空購物車 ")]),(0,s._)("div",I,[(0,s._)("div",N,[(0,s._)("div",T,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control w-75 rounded-0 rounded-start border-end-0",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[1]||(t[1]=e=>U.coupon=e)},null,512),[[d.nr,U.coupon]]),(0,s._)("button",{type:"button",class:"btn btn-outline-danger w-25",onClick:t[2]||(t[2]=(...e)=>le.useCoupon&&le.useCoupon(...e))}," 使用優惠券 ")]),(0,s._)("div",j,[(0,s._)("div",M,[E,(0,s._)("p",null,"NT$ "+(0,l.zw)(U.cartData.total),1)]),(0,s._)("div",O,[A,(0,s._)("p",null," - NT$ "+(0,l.zw)(`${Math.ceil(U.cartData.total-U.cartData.final_total)}`),1)]),(0,s._)("div",F,[H,(0,s._)("p",Y," NT$ "+(0,l.zw)(`${Math.ceil(U.cartData.final_total)}`),1)])])])])])]))]),(0,s._)("div",K,[S,(0,s._)("div",Z,[(0,s.Wm)(ce,{ref:"form",onSubmit:le.submitOrder},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",B,[G,(0,s.Wm)(re,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入收件人姓名",rules:"required",modelValue:U.form.user.name,"onUpdate:modelValue":t[3]||(t[3]=e=>U.form.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(ie,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",J,[P,(0,s.Wm)(re,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:U.form.user.email,"onUpdate:modelValue":t[4]||(t[4]=e=>U.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(ie,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",Q,[R,(0,s.Wm)(re,{id:"phone",name:"聯絡電話",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":e["聯絡電話"]}]),placeholder:"請輸入聯絡電話",rules:"required|min:8|max:10",modelValue:U.form.user.tel,"onUpdate:modelValue":t[5]||(t[5]=e=>U.form.user.tel=e)},null,8,["class","modelValue"]),(0,s.Wm)(ie,{name:"聯絡電話",class:"invalid-feedback"})]),(0,s._)("div",X,[ee,(0,s.Wm)(re,{id:"address",name:"收件地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["收件地址"]}]),placeholder:"請輸入收件地址",rules:"required",modelValue:U.form.user.address,"onUpdate:modelValue":t[6]||(t[6]=e=>U.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(ie,{name:"收件地址",class:"invalid-feedback"})]),(0,s._)("div",te,[ae,(0,s.wy)((0,s._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[7]||(t[7]=e=>U.form.message=e)},null,512),[[d.nr,U.form.message]])]),(0,s._)("button",{type:"submit",class:"btn btn-danger w-100",disabled:0===U.cartData.carts.length||Object.keys(e).length>0}," 確認訂單 ",8,se)])),_:1},8,["onSubmit"])])])])],64)}var de={emits:["emit-order"],data(){return{cartData:{carts:[]},coupon:"",isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""},pay:"default",orderId:""}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart";this.isLoading=!0,this.$http.get(e).then((e=>{console.log(e),this.cartData=e.data.data,this.isLoading=!1})).catch((e=>{alert(e.response),this.isLoading=!1}))},useCoupon(){const e="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/coupon",t={code:this.coupon};this.$http.post(e,{data:t}).then((e=>{console.log(e),alert(e.data.message),this.getCart()}))},changeCart(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart/${e.id}`,a={product_id:e.product.id,qty:e.qty};this.$http.put(t,{data:a}).then((e=>{console.log(e),alert(e.data.message),this.isLoading=!1})).catch((e=>{alert(e.response),this.isLoading=!1}))},deleteCart(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart/${e}`;this.$http.delete(t).then((e=>{console.log(e),alert(e.data.message),this.getCart(),this.isLoading=!1})).catch((e=>{alert(e.response),this.isLoading=!1}))},deleteAllCart(){const e="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/carts";this.$http.delete(e).then((e=>{console.log(e),alert("已清空購物車"),this.getCart()})).catch((e=>{alert(e.response)}))},submitOrder(){const e="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/order";this.isLoading=!0;const t=this.form;this.$http.post(e,{data:t}).then((e=>{console.log(e),alert(e.data.message),this.$refs.form.resetForm(),this.isLoading=!1,this.orderId=e.data.orderId,this.$router.push(`/order/${this.orderId}`),console.log(this.orderId)})).catch((e=>{alert(e.response),this.isLoading=!1}))}},watch:{$route(){this.getCart()}},mounted(){this.getCart(),console.log(this.cartData.carts.product_id)}},oe=a(3744);const re=(0,oe.Z)(de,[["render",le],["__scopeId","data-v-d186d1f4"]]);var ie=re}}]);
//# sourceMappingURL=839.fd87d022.js.map